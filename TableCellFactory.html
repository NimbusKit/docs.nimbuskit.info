<!-- HTML header for doxygen 1.8.6-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6-nimbuskit"/>
<title>NimbusKit: Table Cell Factory</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="appledocs.css" rel="stylesheet" type="text/css"/>
<link href="nimbuskit.css" rel="stylesheet" type="text/css" />
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-24278774-1']);
  _gaq.push(['_setDomainName', 'nimbuskit.info']);
  _gaq.push(['_trackPageview']);
  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<a href="index.html"><img style="float:left" src="nimbus128.png" width="80" height="80" /></a>
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">NimbusKit
   &#160;<span id="projectnumber">1.2.1 - <a href="http://github.com/jverkoey/nimbus">Fork Nimbus on Github</a> - <a href="http://wiki.nimbuskit.info/">Visit the Nimbus Wiki</a></span>
   </div>
   <div id="projectbrief">The iOS framework that grows only as fast as its documentation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6-nimbuskit -->
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('TableCellFactory.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a>  </div>
  <div class="headertitle">
<div class="title">Table Cell Factory<div class="ingroups"><a class="el" href="NimbusModels.html">Nimbus Models</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="NICellFactory.html">NICellFactory</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A simple factory for creating table view cells from objects.  <a href="NICellFactory.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">protocol &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="NICellObject-Protocol.html">&lt;NICellObject&gt;</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">The protocol for an object that can be used in the <a class="el" href="NICellFactory.html" title="A simple factory for creating table view cells from objects. ">NICellFactory</a>.  <a href="NICellObject-Protocol.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">protocol &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="NINibCellObject-Protocol.html">&lt;NINibCellObject&gt;</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">The protocol for an object that can be used in the <a class="el" href="NICellFactory.html" title="A simple factory for creating table view cells from objects. ">NICellFactory</a> with Interface Builder nibs.  <a href="NINibCellObject-Protocol.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">protocol &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="NICell-Protocol.html">&lt;NICell&gt;</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">The protocol for a cell created in the <a class="el" href="NICellFactory.html" title="A simple factory for creating table view cells from objects. ">NICellFactory</a>.  <a href="NICell-Protocol.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Overview</h2>
<p>A table cell factory automatically creates UITableViewCells from objects. </p>
<p>The Nimbus table cell factory works by requiring that objects implement a basic protocol, <a class="el" href="NICellObject.html" title="A light-weight implementation of the NICellObject protocol. ">NICellObject</a>, which sets up a binding from the object to a specific cell implementation. This cell implementation can optionally implement the <a class="el" href="NICell-Protocol.html" title="The protocol for a cell created in the NICellFactory. ">NICell</a> protocol. In practice this is nearly always the case. You then simply use the factory in your table's data source and the factory will handle the rest. This allows you to completely separate presentation from data in your table view controllers.</p>
<h2>A Simple Example: A Twitter Application</h2>
<p>Let's say you want to build a Twitter news feed. We'll assume you've already figured out the network requests and now have individual tweets itching to be displayed. To use the Nimbus factory you will need two different classes: one for the tweet object and its data, and another for the tweet table view cell. Let's call them Tweet and TweetCell, respectively. You may even already have a Tweet object.</p>
<h3>Implement the <a class="el" href="NICellObject.html" title="A light-weight implementation of the NICellObject protocol. ">NICellObject</a> Protocol</h3>
<p>You must first implement the <a class="el" href="NICellObject.html" title="A light-weight implementation of the NICellObject protocol. ">NICellObject</a> protocol in your Tweet object. We want to link the TweetCell table view cell to the Tweet object so that the factory can create a TweetCell when it needs to present the Tweet object.</p>
<div class="fragment"><div class="line"><span class="keyword">@interface </span>Tweet : NSObject &lt;<a class="code" href="NICellObject-Protocol.html">NICellObject</a>&gt; {</div>
<div class="line"><span class="comment">// ...</span></div>
<div class="line">}</div>
<div class="line"><span class="keyword">@end</span></div>
<div class="line"></div>
<div class="line"><span class="keyword">@implementation </span>Tweet</div>
<div class="line"></div>
<div class="line">- (Class)cellClass {</div>
<div class="line">  <span class="keywordflow">return</span> [TweetCell class];</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keyword">@end</span></div>
</div><!-- fragment --><p>Now that we've pointed the Tweet object to the TweetCell class, let's make the table controller use the <a class="el" href="NICellFactory.html" title="A simple factory for creating table view cells from objects. ">NICellFactory</a>.</p>
<h3>Using the Factory</h3>
<p>There are a few ways you can use the factory in your code. We'll walk through increasingly Nimbus-like implementations, starting with a vanilla UIKit implementation.</p>
<p>The following vanilla UIKit implementation has the advantage of allowing you to use <a class="el" href="NICellFactory.html" title="A simple factory for creating table view cells from objects. ">NICellFactory</a> in your existing code base without requiring a full rewrite of your data source. If you are attempting to switch to a pure Nimbus implementation using the cell factory then this is a good first step because it is the least invasive.</p>
<div class="fragment"><div class="line">- (UITableViewCell *)tableView: (UITableView *)tableView</div>
<div class="line">         cellForRowAtIndexPath: (NSIndexPath *)indexPath {</div>
<div class="line">  <span class="comment">// Note: You must fetch the object at this index path somehow. The objectAtIndexPath:</span></div>
<div class="line">  <span class="comment">// is simply an example; replace it with your own implementation.</span></div>
<div class="line">  <span class="keywordtype">id</span> <span class="keywordtype">object</span> = [<span class="keyword">self</span> objectAtIndexPath:indexPath];</div>
<div class="line"></div>
<div class="line">  UITableViewCell* cell = [<a class="code" href="NICellFactory.html">NICellFactory</a> tableViewModel:nil cellForTableView:tableView atIndexPath:indexPath withObject:object];</div>
<div class="line">  <span class="keywordflow">if</span> (nil == cell) {</div>
<div class="line">    <span class="comment">// Here would be whatever code you were originally using to create cells. nil is only returned</span></div>
<div class="line">    <span class="comment">// when the factory wasn&#39;t able to create a cell, likely due to the NICellObject protocol</span></div>
<div class="line">    <span class="comment">// not being implemented for the given object. As you implement these protocols on</span></div>
<div class="line">    <span class="comment">// more objects the factory will automatically start returning the correct cells</span></div>
<div class="line">    <span class="comment">// and you can start removing this special-case logic.</span></div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">return</span> cell;</div>
<div class="line">}</div>
</div><!-- fragment --><p>This next implementation is what your vanilla data source implementation would look like once you have no more custom cell creation code.</p>
<div class="fragment"><div class="line">- (UITableViewCell *)tableView: (UITableView *)tableView</div>
<div class="line">         cellForRowAtIndexPath: (NSIndexPath *)indexPath {</div>
<div class="line">  <span class="comment">// Note: You must fetch the object at this index path somehow. The objectAtIndexPath:</span></div>
<div class="line">  <span class="comment">// is simply an example; replace it with your own implementation.</span></div>
<div class="line">  <span class="keywordtype">id</span> <span class="keywordtype">object</span> = [<span class="keyword">self</span> objectAtIndexPath:indexPath];</div>
<div class="line"></div>
<div class="line">  <span class="comment">// Only use the factory to create cells now that every object used in this controller</span></div>
<div class="line">  <span class="comment">// implements the factory protocols.</span></div>
<div class="line">  <span class="keywordflow">return</span> [<a class="code" href="NICellFactory.html">NICellFactory</a> tableViewModel:nil cellForTableView:tableView atIndexPath:indexPath withObject:object];</div>
<div class="line">}</div>
</div><!-- fragment --><p>If you are using Nimbus models then your code gets even simpler because the object is passed to your model delegate method.</p>
<div class="fragment"><div class="line">- (UITableViewCell *)tableViewModel: (<a class="code" href="NITableViewModel.html">NITableViewModel</a> *)tableViewModel</div>
<div class="line">                   cellForTableView: (UITableView *)tableView</div>
<div class="line">                        atIndexPath: (NSIndexPath *)indexPath</div>
<div class="line">                         withObject: (id)<span class="keywordtype">object</span> {</div>
<div class="line">  <span class="comment">// The model gives us the object, making this much simpler and likely more efficient than the vanilla UIKit implementation.</span></div>
<div class="line">  <span class="keywordflow">return</span> [<a class="code" href="NICellFactory.html">NICellFactory</a> tableViewModel:tableViewModel cellForTableView:tableView atIndexPath:indexPath withObject:object];</div>
<div class="line">}</div>
</div><!-- fragment --><p>And finally, if you require no custom code in your model delegate, the above example can be shortened to a one-liner when you initialize the model:</p>
<div class="fragment"><div class="line"><span class="comment">// This is functionally identical to implementing the delegate in this controller and simply</span></div>
<div class="line"><span class="comment">// calling the factory method.</span></div>
<div class="line">_model.delegate = (id)[<a class="code" href="NICellFactory.html">NICellFactory</a> <span class="keyword">class</span>];</div>
</div><!-- fragment --><h3>Customizing the Cell</h3>
<p>We want to customize the cells as they are presented, otherwise all of the cells will look the same. After our TweetCell object is created in the factory, the factory will call the <a class="el" href="NICell-Protocol.html#shouldUpdateCellWithObject:">shouldUpdateCellWithObject:</a> method on the cell, if it is implemented. Remember that cells are reused in table views and that any modification you may make to the cell could still be present the next time this cell is updated with an object.</p>
<div class="fragment"><div class="line">- (BOOL)shouldUpdateCellWithObject:(<span class="keywordtype">id</span>)<span class="keywordtype">object</span> {</div>
<div class="line">  <span class="comment">// We can be rest assured that `object` is a Tweet object because that&#39;s how we set up</span></div>
<div class="line">  <span class="comment">// the bindings. If more than one type of object maps to this cell class then we&#39;d have</span></div>
<div class="line">  <span class="comment">// to check the object type accordingly.</span></div>
<div class="line">  Tweet* tweet = object;</div>
<div class="line">  <span class="keyword">self</span>.textLabel.text = tweet.text;</div>
<div class="line"></div>
<div class="line">  <span class="comment">// Returning YES or NO here is intended purely for subclassing purposes. Returning YES means</span></div>
<div class="line">  <span class="comment">// that the object changed the cell in some way.</span></div>
<div class="line">  <span class="keywordflow">return</span> YES;</div>
<div class="line">}</div>
</div><!-- fragment --><h3>Conclusions</h3>
<p>The Nimbus cell factory can greatly reduce the amount of code you have to write in your table controllers while separating the data from the presentation. You can slowly ease yourself into using the factory if you already have a large existing code base.</p>
<p>If you are migrating from Three20, you will find that Nimbus' table factory is very similar to TTTableViewController, though greatly simplified and decoupled from the rest of the Three20 ecosystem. Where Three20 provided a tightly integrated solution, Nimbus allows you to plug in the factory where it makes sense. </p>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.6-->
<!-- start footer part -->
<script type="text/javascript" src="widget.js"></script>
</body>
</html>
